# Расширение сущности "Documents" для генерации контекста AI ассистента
entities:
  docs:
    presentations:
      ai-prompt:
        type: ai-prompt
        title: Промпт по документу для создания контекста ассистента
        source: >
          (
            "Сейчас будут перечисленные документы в формате: название и ссылка на документ. Название определяет структуру меню документов через символ '/'. "
            & "После символа '@' будет идти ссылка на документ. По запросу пользователя нужно искать документ и давать ссылку на него. Вот эти документы:\n"
            & (($.docs.$spread().(*.location & "@https://dochub.info/docs/" & $keys()[0]))~>$join("\n"))
            & "\n\nСписок закончен."
          )
        $constructor: >
          (
            /* Получаем объект документа */ 
            $doc := $lookup(docs, $params."dh-doc-id");
            /* Для рендера берем за основу объект документа */
            $merge([$doc, (
              {
                "$base": "/docs/" & $params."dh-doc-id"
              }
            )])
          )
